

CREATE TABLE DEPARTMENT
(DNO VARCHAR2 (20) PRIMARY KEY,
DNAME VARCHAR2 (20), MGRSTARTDATE
DATE);

CREATE TABLE EMPLOYEE
(SSN VARCHAR2(20) PRIMARY KEY,
FNAME VARCHAR2(20),
LNAME VARCHAR2(20),
ADDRESS VARCHAR2 (20),
SEX CHAR (1), 
SALARY INTEGER,
SUPERSSN REFERENCES EMPLOYEE (SSN),
DNO REFERENCES DEPARTMENT (DNO));

ALTER TABLE DEPARTMENT
ADD MGRSSN REFERENCES EMPLOYEE (SSN);

CREATE TABLE DLOCATION
(DLOC VARCHAR2 (20),
DNO REFERENCES DEPARTMENT (DNO),
PRIMARY KEY (DNO, DLOC));

CREATE TABLE PROJECT (
PNO INTEGER PRIMARY KEY, 
PNAME VARCHAR2(20),
PLOCATION VARCHAR2 (20),
DNO REFERENCES DEPARTMENT (DNO));

CREATE TABLE WORKS_ON
(HOURS NUMBER (2),
SSN REFERENCES EMPLOYEE (SSN),
PNO REFERENCES PROJECT(PNO),
PRIMARY KEY (SSN, PNO));

DESC DEPARTMENT;
DESC DLOCATION;
DESC EMPLOYEE;
DESC PROJECT;
DESC WORKS_ON;


INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSECE01','JOHN','SCOTT','BANGALORE','M', 450000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSCSE01','JAMES','SMITH','BANGALORE','M', 500000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSCSE02','HEARN','BAKER','BANGALORE','M', 700000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSCSE03','EDWARD','SCOTT','MYSORE','M', 500000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSCSE04','PAVAN','HEGDE','MANGALORE','M', 650000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSCSE05','GIRISH','MALYA','MYSORE','M', 450000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSCSE06','NEHA','SN','BANGALORE','F', 800000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSACC01','AHANA','K','MANGALORE','F', 350000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSACC02','SANTHOSH','KUMAR','MANGALORE','M', 300000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSISE01','VEENA','M','MYSORE','M', 600000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('ERNSIT01','NAGESH','HR','BANGALORE','M', 500000);


INSERT INTO DEPARTMENT VALUES ('1','ACCOUNTS','01-JAN-01','ERNSACC02'); 
INSERT INTO DEPARTMENT VALUES ('2','IT','01-AUG-16','ERNSIT01');
INSERT INTO DEPARTMENT VALUES ('3','ECE','01-JUN-08','ERNSECE01'); 
INSERT INTO DEPARTMENT VALUES ('4','ISE','01-AUG-15','ERNSISE01'); 
INSERT INTO DEPARTMENT VALUES ('5','CSE','01-JUN-02','ERNSCSE05');

UPDATE EMPLOYEE 
SET SUPERSSN=NULL,DNO='3'
WHERE SSN='ERNSECE01';

UPDATE EMPLOYEE 
SET SUPERSSN='ERNSCSE02',DNO='5'
WHERE SSN='ERNSCSE01';

UPDATE EMPLOYEE 
SET SUPERSSN='ERNSCSE03',DNO='5'
WHERE SSN='ERNSCSE02';

UPDATE EMPLOYEE 
SET SUPERSSN='ERNSCSE04',DNO='5'
WHERE SSN='ERNSCSE03';

UPDATE EMPLOYEE 
SET DNO='5',SUPERSSN='ERNSCSE05'
WHERE SSN='ERNSCSE04';

UPDATE EMPLOYEE 
SET DNO='5',SUPERSSN='ERNSCSE06'
WHERE SSN='ERNSCSE05';

UPDATE EMPLOYEE 
SET DNO='5', SUPERSSN=NULL
WHERE SSN='ERNSCSE06';

UPDATE EMPLOYEE 
SET DNO='1', SUPERSSN='ERNSACC02'
WHERE SSN='ERNSACC01';

UPDATE EMPLOYEE 
SET DNO='1', SUPERSSN=NULL
WHERE SSN='ERNSACC02';

UPDATE EMPLOYEE 
SET DNO='4', SUPERSSN=NULL
WHERE SSN='ERNSISE01';

UPDATE EMPLOYEE 
SET DNO='2', SUPERSSN=NULL
WHERE SSN='ERNSIT01';

SELECT * FROM EMPLOYEE;

INSERT INTO DLOCATION VALUES ('BANGALORE', '1');
INSERT INTO DLOCATION VALUES ('BANGALORE', '2');
INSERT INTO DLOCATION VALUES ('BANGALORE', '3');
INSERT INTO DLOCATION VALUES('MANGALORE','4');
INSERT INTO DLOCATION VALUES('MANGALORE','5');

SELECT * FROM EMPLOYEE;

INSERT INTO PROJECT VALUES (100,'IOT','BANGALORE','5'); 
INSERT INTO PROJECT VALUES (101,'CLOUD','BANGALORE','5');
INSERT INTO PROJECT VALUES (102,'BIGDATA','BANGALORE','5');
INSERT INTO PROJECT VALUES (103,'SENSORS','BANGALORE','3');
INSERT INTO PROJECT VALUES (104,'BANK MANAGEMENT','BANGALORE','1');
INSERT INTO PROJECT VALUES (105,'SALARYMANAGEMENT','BANGALORE','1');
INSERT INTO PROJECT VALUES(106,'OPENSTACK','BANGALORE','4');
INSERT INTO PROJECT VALUES (107,'SMARTCITY','BANGALORE','2');

INSERT INTO WORKS_ON VALUES (4, 'ERNSCSE01', 100);
INSERT INTO WORKS_ON VALUES (6, 'ERNSCSE01', 101);
INSERT INTO WORKS_ON VALUES (8, 'ERNSCSE01', 102);
INSERT INTO WORKS_ON VALUES (10, 'ERNSCSE02', 100);
INSERT INTO WORKS_ON VALUES (3, 'ERNSCSE04', 100);
INSERT INTO WORKS_ON VALUES (4, 'ERNSCSE05', 101);
INSERT INTO WORKS_ON VALUES (5, 'ERNSCSE06', 102);
INSERT INTO WORKS_ON VALUES (6,'ERNSCSE03', 102);
INSERT INTO WORKS_ON VALUES (7,'ERNSECE01', 103);
INSERT INTO WORKS_ON VALUES (5, 'ERNSACC01', 104);
INSERT INTO WORKS_ON VALUES (6, 'ERNSACC02', 105);
INSERT INTO WORKS_ON VALUES (4, 'ERNSISE01', 106);
INSERT INTO WORKS_ON VALUES (10, 'ERNSIT01', 107);


SELECT * FROM EMPLOYEE;
SELECT * FROM DEPARTMENT;
SELECT * FROM DLOCATION;
SELECT * FROM PROJECT;
SELECT * FROM WORKS_ON;



(SELECT DISTINCT P.PNO
FROM PROJECT P, DEPARTMENT D, EMPLOYEE E
WHERE E.DNO=D.DNO
AND D.MGRSSN=E.SSN
AND E.LNAME='SCOTT')
UNION
(SELECT DISTINCT P1.PNO
FROM PROJECT P1, WORKS_ON W, EMPLOYEE E1
WHERE P1.PNO=W.PNO
AND E1.SSN=W.SSN
AND E1.LNAME='SCOTT');

/*Querry 1*/

SELECT E.FNAME, E.LNAME, 1.1*E.SALARY AS INCR_SAL FROM
EMPLOYEE E, WORKS_ON W, PROJECT P
WHERE E.SSN=W.SSN
AND W.PNO=P.PNO
AND P.PNAME='IOT';

/*Querry 2*/



SELECT SUM (E.SALARY), MAX (E.SALARY), MIN (E.SALARY), AVG
(E.SALARY)
FROM EMPLOYEE E, DEPARTMENT D
WHERE E.DNO=D.DNO
AND D.DNAME='ACCOUNTS';
/*Querry 3*/



SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
WHERE NOT EXISTS((SELECT PNO
FROM PROJECT 
WHERE DNO='5')
MINUS (SELECT PNO
FROM WORKS_ON
WHERE E.SSN=SSN));

/*Querry 4*/

SELECT D.DNO, COUNT (*)
FROM DEPARTMENT D, EMPLOYEE E
WHERE D.DNO=E.DNO
AND E.SALARY>600000
AND D.DNO IN (SELECT E1.DNO
FROM EMPLOYEE E1 GROUP
BY E1.DNO HAVING COUNT
(*)>5)
GROUP BY D.DNO;

/*Querry 5*/

/*DROP TABLE DLOCATION;
DROP TABLE DEPARTMENT;
DROP TABLE EMPLOYEE;
DROP TABLE PROJECT;
DROP TABLE WORKS_ON;
*/